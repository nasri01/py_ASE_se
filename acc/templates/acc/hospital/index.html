{% extends 'base3.html' %}
{% load static %}

{% block content %}
<title>پنل کاربری بیمارستان</title>


<link rel="stylesheet" type="text/css" media="all" href="{% static 'JalaliJSCalendar/skins/calendar-blue.css' %}" title="Aqua" />
<script src="{% static 'JalaliJSCalendar/jalali.js' %}"></script>
<script src="{% static 'JalaliJSCalendar/calendar.js' %}"></script>
<script src="{% static 'JalaliJSCalendar/calendar-setup.js'%}"></script>
<script src="{% static 'JalaliJSCalendar/lang/calendar-fa.js' %}"></script>

  <div class="container-fluid">

        <div class="row">
            <div class="col-lg-4 col-md-12" style="direction: rtl;">
                <div>
                    <div style="width: 100%;text-align: center;">
                    <img src="{% static 'img/sairan.svg' %}" class="logo" alt="">
                    </div>
                        <div class="data-box-2">

                            {% if date_error %}
                            <div class="warning-box">
                                {{date_error}}
                            </div>
                            {% endif %}
                            <div class="hospital">
                                <div style="font-size: 12px;">
                                بیمارستان آموزشی درمانی فوق تخصصی الزهرا (س)
                                آدرس: استان اصفهان، اصفهان، بلوار صفه
                                    ساعات بازدید: شبانه‌روزی باز است
                                </div>
                                <img src="{{ auser.avatar.url }}" class="hospital-img">
                                <div class="setting-icon">
                                    <a href="{% url  'report-pdf1'%}" >
                                        <img style="display: block" src="{% static 'img/setting2.ico' %}"  alt="">
                                    </a>
                                </div>
                                <div class="exit-btn">
                                    <a href="{% url 'logout1'%}" style="display: block;color:white;"> خروج <img src="{% static 'img/icons8-shutdown-24(1).png' %}" style="margin-top: 3px;" alt=""></a>
                                </div>
                            </div>
                            <br>
                            <!--<button type="button" class="btn btn-outline-primary" style="border-radius: 20px;">PDF</button>-->
                            <!--<button type="button" class="btn btn-outline-success" style="border-radius: 20px;">Exel</button>-->
                            
                            <!-- &#10004; ///////////////////// tick  -->
                            
                            <div class="excel-report">
                                <div class="excel-btn">گزارش Excel</div>
                                <!-- <br> -->
                                <!-- <br> -->
                                <div style="height: 250px;"></div>
                                <!-- <div class="card card-body" style="border:none;"> -->
                                    <form action="{% url 'report-xlsx' %}" method="GET">
                                        <div class="fm">
                                            <div>
                                                <div class="form-group">
                                                    <label>از: </label>
                                                
                                                        <input type="text"  name="start_date" id="date_input" class="form-control inp" >
                                                        <img  src="{% static 'img/calender.svg' %}"  id="date_btn" height="25px">
                                                        

                                                        <script>
                                                                Calendar.setup({
                                                                  inputField: 'date_input',
                                                                  button: 'date_btn',
                                                                  ifFormat: '%Y/%m/%d',
                                                                  dateType: 'jalali'
                                                                });
                                                                </script>

                                                </div>
                                                <div class="form-group">
                                                    <label>تا: </label>
                                                    <input type="text" name="end_date" id="date_input_2" class="form-control inp" >
                                                    <img  src="{% static 'img/calender.svg' %}"  id="date_btn_2" height="25px" >
                                                    <script>
                                                            Calendar.setup({
                                                              inputField: 'date_input_2',
                                                              button: 'date_btn_2',
                                                              ifFormat: '%Y/%m/%d',
                                                              dateType: 'jalali'
                                                            });
                                                            </script>
                                                </div>
                                                <div class="form-group">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" name="is_recal" class="custom-control-input" id="defaultUnchecked">
                                                        <label class="custom-control-label" for="defaultUnchecked">فقط گزارشات ریکالیبراسیون</label>
                                                    </div>
                                                </div>
                                        </div>
                                        </div>


                                    <div class="flex-btn">
                                        <button type="submit" class="btn btn-primary" name="action" value="show" style="border-radius: 20px;width: 125px;padding: 10px 0;background-color: #114476;border-color:#114476;">نمایش</button>
                                        <button type="submit" class="btn btn-success" name="action" value="download" style="border-radius: 20px;width: 125px;padding: 10px 0;">دانلود</button>
                                    </div>
                                 </form>
                                <!-- </div> -->


                            </div>
                        </div>
                        <br>
                        <div class="report-list" style="position: relative;">
                            <div class="report-list-btn">
                                لیست درخواست
                            </div>
                            <div style="margin-top: 140px;"></div>
                            <div class="report-table">
                                <table style="width: 100%;text-align: center;height: 100px;">
                                    <thead>
                                    
                                            <tr class="th-head">
                                                    <th style="background-color:#74c4b6;border-top-right-radius: 10px;">ردیف</th>
                                                    <th style="background-color:#74c4b6;">تاریخ</th>
                                                    <th style="background-color:#74c4b6;">وضعیت</th>
                                                </tr>
                                    </thead>
                                    <tbody style="height: 100px;">




                                        {% for req in request %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td>{{ req.date }}</td>
                                            <td>
                                                {% if req.status.id == 1%}
                                                    <div style="background-color:#00ff00;width: 15px;height: 15px;border-radius: 100%;display: inline-block;margin-bottom: -3px;">
                                                {% elif req.status.id == 2 %}
                                                    <div style="background-color:#FEFA01;width: 15px;height: 15px;border-radius: 100%;display: inline-block;margin-bottom: -3px;" class="blink"></div>
                                                {% elif req.status.id == 3 %}
                                                    <div style="background-color:#0000ff;width: 15px;height: 15px;border-radius: 100%;display: inline-block;margin-bottom: -3px;">
                                                {% elif req.status.id == 4 %}
                                                    <div style="background-color:#ff0000;width: 15px;height: 15px;border-radius: 100%;display: inline-block;margin-bottom: -3px;">    
                                                {% endif %}
                                            
                                            </div>
                                            {% if req.status.id == 2 %}    
                                                <span class="blink">{{ req.status }}</span>
                                            {% else %}
                                                {{ req.status }}
                                            {% endif %}
                                            </td>
                                        </tr>

                                        {% endfor %}


                            
                                  
                                    </tbody>
                                </table>
                            </div>
                        </div>
                </div>
            </div>
            <!--  -->
            <div class="col-lg-8 col-md-12" style="direction: rtl;">
                    <div class="data-box">
                       
                        <style>
                        
                            table.dataTable thead .sorting:after,
                            table.dataTable thead .sorting:before,
                            table.dataTable thead .sorting_asc:after,
                            table.dataTable thead .sorting_asc:before,
                            table.dataTable thead .sorting_asc_disabled:after,
                            table.dataTable thead .sorting_asc_disabled:before,
                            table.dataTable thead .sorting_desc:after,
                            table.dataTable thead .sorting_desc:before,
                            table.dataTable thead .sorting_desc_disabled:after,
                            table.dataTable thead .sorting_desc_disabled:before {
                            bottom: .5em;
                            }
                        </style>
                        <table style="border-radius: 10px; width: 100%;" id="dtBasicExample" class="table table-striped table-bordered table-sm" cellspacing="0">
                            <!--///////////////////////////////////-->
                                <thead  class="thead-light">		
				<tr class="t-row">
                                <th class="th-sm">{{firstrow.2}}</th>
                                <th class="th-sm">{{firstrow.3}}</th>
                                <th class="th-sm">{{firstrow.4}}</th>
                                <th class="th-sm">{{firstrow.5}}</th>
                                <th class="th-sm">{{firstrow.6}}</th>
                                <th class="th-sm">{{firstrow.7}}</th>
                                <th class="th-sm">{{firstrow.8}}</th>
                                <th class="th-sm">{{firstrow.9}}</th>
                                <th class="th-sm">{{firstrow.10}}</th>
                                <th class="th-sm">{{firstrow.11}}</th>
                                <th class="th-sm">{{firstrow.12}}</th>
                                <th class="th-sm">{{firstrow.13}}</th>
                                <th class="th-sm">{{firstrow.14}}</th>
                                <th class="th-sm">{{firstrow.15}}</th>
                                {% if data %}
                                	<th class="th-sm">PDF</th>
                                {% endif %}
                            </tr>
                            {% for i in data %}

                                <tr class="t-row">
                                     <td>{{i.device.hospital.city.state_name.name}}</td>
                                    <td>{{i.device.hospital.city.name}}</td>
                                    <td>{{i.device.hospital.name}}</td>
                                    <td>{{i.device.section.name}}</td>
                                    <td>{{i.device.name.type.name}}</td>
                                    <td>{{i.device.name.creator.name}}</td>
                                    <td>{{i.device.name.name}}</td>
                                    <td>{{i.device.serial_number}}</td>
                                    <td>{{i.device.property_number}}</td>
                                    <td>{{i.status.status}}</td>
                                    <td>{{i.date|date:'Y-m-d'}}</td>
                                    <td>{{firstrow.0}}</td>
                                    
                                    {% if i.licence.number != -1%}
				                	<td>{{i.licence.number}}</td>
                                    {% else%}
                                    	<td>-</td>
                                    {% endif %}
                                    
                                    <td>
                                        {% for t in i.totalcomment.all %}
                                            {{t}}
                                        {% endfor %}
                                    </td>
                                    
                                    {% if i.status.id != 4 %}
                                        <form method="GET" action="{% url 'report-pdf1'%}">
                                            <td> <button type="submit" value="{{i.licence.number}}" name="licence_num" class="btn"><img src="{% static 'img/arrow-pointing-down.png' %}" class="download-icon" alt="download-icon"></td>
                                        </form>
                                    {% endif %}
                                
                                </tr>
                            {% empty %}
                                <div style="text-align:center;font-size: 25px;margin-top: 240px;font-weight: bold;">داده ای جهت نمایش وجود ندارد.</div>
                            {% endfor %}

                          </tbody>
                        </table>
                     </div>
			<!-- end of data-box -->
                     <div class="row">
                   
                            <div class="col-md-12 col-lg-5">
                                <div class="data-box-em">

                                </div>
                                </div>
            
                   
                        <div class="col-md-12 col-lg-7">
                        <div class="chart-box">
                        <canvas id="doughnutChart"></canvas>
                    </div>
                </div>
                </div><!---row end -->



                </div>
            
        </div>
            <!--  -->
        </div>
    </div>

{% endblock %}
